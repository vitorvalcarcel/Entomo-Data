<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Mapear Colunas</title>
    <link rel="stylesheet" th:href="@{/css/estilo.css}">
</head>
<body>

    <div class="header-container">
        <h1>üîó Vincular Colunas <span style="font-weight: normal; font-size: 0.8em; color: #7f8c8d;">| Passo 2 de 2</span></h1>
    </div>
    
    <div class="grupo-campos" style="margin-bottom: 20px;">
        <p style="margin: 0; color: #555;">
            O sistema encontrou as colunas abaixo no seu arquivo: <strong th:text="${nomeArquivoSalvo}" style="color: #2c3e50;"></strong>.
        </p>
        <p style="margin: 5px 0 0 0; font-size: 14px; color: #7f8c8d;">
            Clique no bot√£o <strong>"Selecionar..."</strong> √† direita para definir o que cada coluna representa.
        </p>
    </div>

    <form th:action="@{/importar/finalizar}" method="post" id="formMapeamento">
        
        <input type="hidden" name="nomeArquivo" th:value="${nomeArquivoSalvo}">

        <div th:each="coluna : ${colunasExcel}" class="card-coluna" th:id="'card-' + ${coluna.nome}">
            
            <div class="info-coluna">
                <span class="nome-coluna">
                    üìÑ <span th:text="${coluna.nome}">Nome da Coluna Excel</span>
                </span>
                
                <div class="amostras-container">
                    <span style="margin-right: 5px; font-weight: 600;">Amostra de dados:</span>
                    <span th:each="amostra : ${coluna.amostras}" class="amostra-dado" th:text="${amostra}">Dado 1</span>
                    <span th:if="${coluna.amostras.empty}" style="font-style: italic; color: #999;">(Sem dados nas primeiras linhas)</span>
                </div>
            </div>

            <div class="select-area">
                <input type="hidden" th:name="${coluna.nome}" class="input-valor-mapeado">
                <button type="button" class="btn-selecionar" onclick="abrirModal(this)">
                    Selecionar...
                </button>
            </div>

        </div>

        <div style="margin-top: 20px; text-align: right; padding-bottom: 50px;">
            <a href="/importar" class="btn btn-paginacao" style="margin-right: 10px;">Voltar</a>
            <button type="submit" class="btn btn-salvar">Finalizar Importa√ß√£o ‚úÖ</button>
        </div>
    </form>
    
    <div id="modalSelecao" class="modal-overlay" onclick="fecharModal(event)">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Selecione o campo correspondente</h3>
                <button type="button" class="btn-fechar" onclick="fecharModal(null)">√ó</button>
            </div>
            <div class="modal-body">
                
                <div class="grupo-selecao">
                    <div class="titulo-grupo-modal">Identifica√ß√£o</div>
                    <div class="grid-opcoes">
                        <button type="button" class="btn-opcao" onclick="selecionarCampo('cod', 'C√≥digo (ID)')">C√≥digo (ID)</button>
                        <button type="button" class="btn-opcao" style="color: #e74c3c; border-color: #fadbd8;" onclick="selecionarCampo('', 'Selecionar...')">‚õî Ignorar Coluna</button>
                    </div>
                </div>

                <div class="grupo-selecao">
                    <div class="titulo-grupo-modal">Taxonomia</div>
                    <div class="grid-opcoes">
                        <button type="button" class="btn-opcao" onclick="selecionarCampo('familia', 'Fam√≠lia')">Fam√≠lia</button>
                        <button type="button" class="btn-opcao" onclick="selecionarCampo('subfamilia', 'Subfam√≠lia')">Subfam√≠lia</button>
                        <button type="button" class="btn-opcao" onclick="selecionarCampo('tribo', 'Tribo')">Tribo</button>
                        <button type="button" class="btn-opcao" onclick="selecionarCampo('subtribo', 'Subtribo')">Subtribo</button>
                        <button type="button" class="btn-opcao" onclick="selecionarCampo('genero', 'G√™nero')">G√™nero</button>
                        <button type="button" class="btn-opcao" onclick="selecionarCampo('subgenero', 'Subg√™nero')">Subg√™nero</button>
                        <button type="button" class="btn-opcao" onclick="selecionarCampo('especie', 'Esp√©cie')">Esp√©cie</button>
                        <button type="button" class="btn-opcao" onclick="selecionarCampo('subespecie', 'Subesp√©cie')">Subesp√©cie</button>
                        
                        <button type="button" class="btn-opcao" onclick="selecionarCampo('autor', 'Autor')">Autor</button>
                        <button type="button" class="btn-opcao" onclick="selecionarCampo('determinador', 'Determinador')">Determinador</button>
                        <button type="button" class="btn-opcao" onclick="selecionarCampo('sexo', 'Sexo')">Sexo</button>
                        <button type="button" class="btn-opcao" onclick="selecionarCampo('especieVegetalAssociada', 'Esp√©cie Vegetal Associada')">Esp√©cie Vegetal Associada</button>
                    </div>
                </div>

                <div class="grupo-selecao">
                    <div class="titulo-grupo-modal">Localiza√ß√£o</div>
                    <div class="grid-opcoes">
                        <button type="button" class="btn-opcao" onclick="selecionarCampo('pais', 'Pa√≠s da Coleta')">Pa√≠s da Coleta</button>
                        <button type="button" class="btn-opcao" onclick="selecionarCampo('estado', 'Estado da Coleta')">Estado da Coleta</button>
                        <button type="button" class="btn-opcao" onclick="selecionarCampo('cidade', 'Cidade/Munic√≠pio da Coleta')">Cidade/Munic√≠pio da Coleta</button>
                        <button type="button" class="btn-opcao" onclick="selecionarCampo('localidade', 'Localidade Espec√≠fica da Coleta')">Localidade Espec√≠fica da Coleta</button>
                        <button type="button" class="btn-opcao" onclick="selecionarCampo('proprietarioDoLocalDeColeta', 'Propriet√°rio do Local da Coleta')">Propriet√°rio do Local da Coleta</button>
                        <button type="button" class="btn-opcao" onclick="selecionarCampo('bioma', 'Bioma')">Bioma</button>
                        <button type="button" class="btn-opcao" onclick="selecionarCampo('latitude', 'Latitude')">Latitude</button>
                        <button type="button" class="btn-opcao" onclick="selecionarCampo('longitude', 'Longitude')">Longitude</button>
                    </div>
                </div>

                <div class="grupo-selecao">
                    <div class="titulo-grupo-modal">Coleta e Armazenamento</div>
                    <div class="grid-opcoes">
                        <button type="button" class="btn-opcao" onclick="selecionarCampo('data', 'Data da Coleta')">Data da Coleta</button>
                        <button type="button" class="btn-opcao" onclick="selecionarCampo('horarioColeta', 'Hor√°rio da Coleta')">Hor√°rio da Coleta</button>
                        <button type="button" class="btn-opcao" onclick="selecionarCampo('coletor', 'Coletor')">Coletor</button>
                        <button type="button" class="btn-opcao" onclick="selecionarCampo('metodoDeAquisicao', 'M√©todo de Coleta')">M√©todo de Coleta</button>
                        <button type="button" class="btn-opcao" onclick="selecionarCampo('gaveta', 'Gaveta')">Gaveta</button>
                        <button type="button" class="btn-opcao" onclick="selecionarCampo('caixa', 'Caixa')">Caixa</button>
                    </div>
                </div>
            
            </div>
        </div>
    </div>

    <script src="/js/mapeamento.js"></script>

</body>
</html>